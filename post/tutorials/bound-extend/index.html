<!doctype html><html lang=en-us><head><meta charset=utf-8><link rel=icon type=image/png sizes=32x32 href=/img/logo.png><meta name=viewport content="width=device-width,initial-scale=1"><title>Extracting the boundary extends of polygons in a shapefile using QGIS and VBA in Microsoft excel - Arun Gopinath</title><meta property="og:title" content="Extracting the boundary extends of polygons in a shapefile using QGIS and VBA in Microsoft excel - Arun Gopinath"><meta name=twitter:card content="summary"><meta property="description" content="Extracting the boundary extends or bbox values of all the polygons in a shapefile using QGIS is explained here. The obtained decimal values are converted into Degree Minute Seconds form using Visual Basic for Application (VBA) in Microsoft Excel"><meta property="og:description" content="Extracting the boundary extends or bbox values of all the polygons in a shapefile using QGIS is explained here. The obtained decimal values are converted into Degree Minute Seconds form using Visual Basic for Application (VBA) in Microsoft Excel"><meta name=twitter:image content="https://user-images.githubusercontent.com/53209422/106386381-b8e63300-63fa-11eb-9bdc-8def30a46145.jpg"><link href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/custom.css></head><body class=post><header class=masthead><h1><a href=/><img src=/img/logo.png alt="Arun Gopinath"></a></h1><p class=tagline>Welcome to blog of Arun Gopinath</p><nav class=menu><input id=menu-check type=checkbox hidden>
<label id=menu-label for=menu-check class=unselectable hidden><span class="icon close-icon">✕</span>
<span class="icon open-icon">☰</span>
<span class=text>Menu</span></label><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/post/>Blog</a></li><li><a href=/galleries/>Gallery</a></li><li><a href=/categories/>Category</a></li></ul></nav></header><article class=main><header class=title><h1>Extracting the boundary extends of polygons in a shapefile using QGIS and VBA in Microsoft excel</h1><h3>Arun Gopinath
/ 2021-01-30</h3><hr></header><h1 id=introduction>Introduction</h1><p>In this tutorial lets us learn how to extract the boundary limits or bbox values of each polygon in a shapefile using QGIS. First of all, imagine a shapefile consists of some number of polygons. So each polygon can be exactly fit into imaginary rectangles each having upper and lower limits of latitude and longitude values. These four limits will be the boundary for that polygon. Similarly, remaining polygons will also have such boundaries. In this article, we will extract those values into a spreadsheet format.</p><h2 id=required-tools>Required tools</h2><ul><li><p>QGIS</p></li><li><p>Mircrosoft Excel</p></li></ul><h2 id=follow-these-steps>Follow these steps</h2><p>To calculate the boundary extend of a shapefile ( Contains multiple polygons )</p><ol><li>Open the required shapefile in <strong>QGIS</strong></li></ol><p><img src=https://user-images.githubusercontent.com/53209422/106386381-b8e63300-63fa-11eb-9bdc-8def30a46145.jpg alt=0></p><ol start=2><li>Now open attribute table</li></ol><p><img src=https://user-images.githubusercontent.com/53209422/106386388-c1d70480-63fa-11eb-97e0-9139815dfe41.jpg alt="1 "></p><ol start=3><li>Click Start editing button (pencil) [Ctrl + E].</li></ol><p><img src=https://user-images.githubusercontent.com/53209422/106386397-ca2f3f80-63fa-11eb-8693-c2d0f788e2da.jpg alt="2 "></p><p>Also, select &lsquo;Open Field Calculator&rsquo; [ Ctrl + I ]</p><p><img src=https://user-images.githubusercontent.com/53209422/106386403-d0bdb700-63fa-11eb-9733-cb17159f522e.jpg alt=3></p><ol start=4><li>Check create new field, Add output field name as xmin</li></ol><blockquote><p>xmin and xmax represents North(upper limit) and South (lower limt) of boundary respectively. Similarly ymin and ymax represents West and East boundary limts.</p></blockquote><ol start=5><li><p>Output field type as &rsquo;text&rsquo;</p></li><li><p>Output field type = 20 (Optional)</p></li><li><p>In the Expression tab below, enter</p></li></ol><pre tabindex=0><code>x_min($geometry)
</code></pre><blockquote><p>If everything is fine, then an output preview can be seen in the left bottom of that tab.</p></blockquote><p><img src=https://user-images.githubusercontent.com/53209422/106387357-6a876300-63ff-11eb-8ef7-9529f1c383da.jpg alt=4></p><ol start=8><li>Click OK. The attribute table will be populated with xmin values.</li></ol><p><img src=https://user-images.githubusercontent.com/53209422/106386413-da471f00-63fa-11eb-8b96-8516219ed845.jpg alt=5></p><blockquote><p>The values will be in decimals. We have to convert it into DMS(Degree,Minute,Seconds) later.</p></blockquote><ul><li>Similarly, follow the above steps for xmax, ymin & ymax. Respective expressions will be</li></ul><pre tabindex=0><code>x_max($geometry)

y_min($geometry)
 
y_max($geometry)
</code></pre><p><img src=https://user-images.githubusercontent.com/53209422/106386416-df0bd300-63fa-11eb-98b1-33f8806a4b03.jpg alt=6></p><ol start=9><li>Now in the layers panel of QGIS, right click to save as the shape file as .csv format and click save.</li></ol><p><img src=https://user-images.githubusercontent.com/53209422/106386419-e337f080-63fa-11eb-89d3-f2da86ba6144.jpg alt=7></p><p><img src=https://user-images.githubusercontent.com/53209422/106386424-e92dd180-63fa-11eb-86ec-ca22a81f0b51.jpg alt=8></p><p><img src=https://user-images.githubusercontent.com/53209422/106386428-ecc15880-63fa-11eb-90af-ab1d6a698d84.jpg alt=9></p><ol start=10><li><p>Now open the above saved spread sheet in Excel.</p></li><li><p>Add XMIN, XMAX, YMIN and YMAX columns.</p></li></ol><p><img src=https://user-images.githubusercontent.com/53209422/106386431-efbc4900-63fa-11eb-8a6f-82e1aa487fbf.jpg alt=10></p><ol start=12><li><p>Click Alt + F11 , which means you are opening the Visual Basic for Applications (VBA)</p></li><li><p>Select <strong>Insert</strong> , then <strong>Module</strong></p></li></ol><p><img src=https://user-images.githubusercontent.com/53209422/106386434-f3e86680-63fa-11eb-816e-21b0278ebc40.jpg alt=11></p><ol start=14><li>A blank tab will open up. Copy the code given below and paste it in that blank space.</li></ol><pre tabindex=0><code>Function Convert_Degree(Decimal_Deg) As Variant
    With Application
        &#39;Set degree to Integer of Argument Passed
        Degrees = Int(Decimal_Deg)
        &#39;Set minutes to 60 times the number to the right
        &#39;of the decimal for the variable Decimal_Deg
        Minutes = (Decimal_Deg - Degrees) * 60
        &#39;Set seconds to 60 times the number to the right of the
        &#39;decimal for the variable Minute
        Seconds = Format(((Minutes - Int(Minutes)) * 60), &#34;0.000&#34;)
        &#39;Returns the Result of degree conversion
        &#39;(for example, 10.46 = 10~ 27  &#39; 36&#34;)
        Convert_Degree = &#34; &#34; &amp; Degrees &amp; &#34;° &#34; &amp; Int(Minutes) &amp; &#34; &#39; &#34; &amp; Seconds + Chr(34)
    End With
End Function
</code></pre><p><img src=https://user-images.githubusercontent.com/53209422/106386438-f77bed80-63fa-11eb-86eb-da409ea138ba.jpg alt=12></p><blockquote><p>Click Alt + F11 to go back to the spreadsheet.</p></blockquote><ol start=15><li>Now select the cell just below the XMIN and type</li></ol><pre tabindex=0><code>=Convert_Degree(C2)
</code></pre><p>in the formula box and click <strong>ENTER</strong>.</p><p><strong>Change the C2 with the cell name contains the first decimal value of xmin</strong>.</p><p><img src=https://user-images.githubusercontent.com/53209422/106386440-fa76de00-63fa-11eb-9e40-02a596d1e14f.jpg alt=13></p><ol start=16><li><p>Drag the + sign in the right bottom corner of the same cell to the last valued row.</p></li><li><p>Repeat the same for XMAX, YMIN and YMAX.</p></li></ol><p><img src=https://user-images.githubusercontent.com/53209422/106386445-fd71ce80-63fa-11eb-8473-5563365044f4.jpg alt=14></p><blockquote><p>Note: Remember to change the cell value in the Step 15 in next steps.</p></blockquote><ol start=18><li>Save the file in Excel macro enabled format (.xlxm). By selecting this format, the module we added in VBA will be attached with the workbook.</li></ol><p><img src=https://user-images.githubusercontent.com/53209422/106386448-006cbf00-63fb-11eb-974f-489896d06ba2.jpg alt=15></p><h3 id=things-to-be-noted>Things to be noted</h3><p>If the required output is in decimal values, then up to step 9 is enough. Those processes are also possible in ArcGIS software.</p><p><a href=https://gpay.app.goo.gl/pay-sCjOGpyBhXM target=_blank><img src=https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png alt="Buy Me A " style="height:41px!important;width:174px!important;box-shadow:0 3px 2px rgba(190,190,190,.5)!important;-webkit-box-shadow:0 3px 2px 0 rgba(190,190,190,.5)!important"></a></p><nav class=post-nav><span class=nav-prev>&larr; <a href=/post/thoughts/2020/election2020/>പെരുങ്കടവിള തദ്ദേശ തിരഞ്ഞെടുപ്പിന്റെ ചില സ്ഥിതി വിവര കണക്കുകൾ</a></span>
<span class=nav-next><a href=/post/tutorials/assembly2021/>Detailed map of Kerala assembly elections 2021</a> &rarr;</span></nav><script type=text/javascript>document.addEventListener("keyup",function(e){if(e.target.nodeName.toUpperCase()!="BODY")return;var t=!1;e.which==37?t="/post/thoughts/2020/election2020/":e.which==39&&(t="/post/tutorials/assembly2021/"),t&&(window.location=t)})</script><section class=comments><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://arungopi.gitlab.io"+location.pathname};(function(){if(a=function(){var e=!0;try{e=window.self!==window.top}catch{}return e},a())return;var e,s,o,i,a,r="//blogging-and-beyond.disqus.com/embed.js",t=document,n=t.createElement("script");if(n.src=r,n.async=!0,n.setAttribute("data-timestamp",+new Date),e=t.getElementById("disqus_thread"),s=!1,o=function(o){if(s)return;(t.head||t.body).appendChild(n),s=!0,o&&e.scrollIntoView()},n.onerror=function(){if(sessionStorage.getItem("failure-note"))return;e.innerText="Sorry, but you cannot make comments because Disqus failed to load for some reason. If you are sure it is not blocked in your region, please refresh the page. 中国大陆地区读者需要翻墙才能发表评论。",e.style.border="1px dashed",e.style.padding=".5em",e.style.background="lightyellow",sessionStorage.setItem("failure-note",!0)},location.hash.match(/^#comment-[0-9]+$/))return o(!0);i=function(){if(s)return;var t=e.getBoundingClientRect();t.top<window.innerHeight&&t.bottom>=0&&o()},window.addEventListener("load",i),t.addEventListener("scroll",i)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></section><script async src=/js/fix-toc.js></script>
<script async src=/js/center-img.js></script>
<script async src=/js/right-quote.js></script>
<script async src=/js/no-highlight.js></script>
<script async src=/js/fix-footnote.js></script>
<script async src=/js/math-code.js></script>
<script async src=/js/external-link.js></script>
<script async src=/js/alt-title.js></script>
<script async src=/js/header-link.js></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/tex.min.js></script>
<script>hljs.configure({languages:[]}),hljs.initHighlightingOnLoad()</script><hr><div class=copyright>© <a href=/>Arun Gopinath</a> 2019-2021</div></footer></article><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-159568026-1","auto"),ga("send","pageview"))</script></body></html>